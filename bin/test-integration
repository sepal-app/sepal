#!/bin/bash
# Script to run integration tests locally in Docker

set -e

BROWSER=${1:-chromium}

echo "ðŸ§ª Running integration tests with $BROWSER..."
echo ""

if [ "$BROWSER" = "both" ]; then
    echo "Running tests in both Chromium and Firefox..."
    docker-compose -f docker-compose.integration.yml up --build --abort-on-container-exit
else
    echo "Building Docker image for $BROWSER..."
    docker build \
        -f Dockerfile.integration \
        --build-arg BROWSER=$BROWSER \
        -t sepal-integration:$BROWSER \
        .

    echo ""
    echo "Running integration tests..."
    docker run --rm \
        -e PLAYWRIGHT_BROWSER=$BROWSER \
        sepal-integration:$BROWSER
fi

echo ""
echo "âœ… Integration tests complete!"
